---
layout: post
title: Git (3)
category: Git
tag: Git
---



본 포스트의 내용은 [깃 교과서, 이호진, 길벗, 2020](http://www.yes24.com/Product/Goods/89522012) 을 참고하여 작성하였습니다.



# 서버 저장소

## 깃허브 생성과 연동

- 깃허브는 대표적인 깃 호스팅(Git hosting) 서비스이다. 깃허브 외에도 깃랩(Gitlab), 비트버킷(Bitbucket) 등의 깃호스팅 사이트가 있다.



- 저장소 생성하기 (깃허브 가입 과정은 생략)

  - Github 로그인 후 메인화면에서 좌측에 보이는 Repository 상단에 있는 초록색 New 버튼을 누르거나 Repository 탭에 들어가서 초록색 New 버튼을 누른다.



- 로컬 저장소와 원격 저장소 연결
  - 원격 저장소와 연결하고 싶은 디렉터리를 생성한 뒤 다음 폴더 안으로 이동하여 `init`을 이용하여 초기화한다. 
  - `remote` 명령어를 통해 원격 저장소에 연결할 수 있다.

  ```bash
  $ git remote add <원격 저장소 별칭> <원격 저장소 url>
  ```

  - `remote -v` 명령어를 사용하면 연결된 원격 저장소의 주소를 확인할 수 있다.

  ```bash
  $ git remote -v
  # fetch : pull하여 가져올 때의 주소이다.
  # push : push하여 전송할 때의 주소이다.
  ```

  - 원격 저장소 삭제하기

  ```bash
  $ git remote rm <원격 저장소 별칭>
  ```

  - 기존 원격 저장소를 그대로 로컬 저장소로 가져오고 싶다면 저장소 복제 `clone` 을 사용한다.

  ```bash
  $ git clone <원격 저장소 url>
  ```



- 서버에 전송하기 & 서버에서 내려받기 : `push` 명령어를 사용하여 전송할 수 있고 `pull` 명령어를 사용하여 내려받을 수 있다. `fetch` 명령어를 통해서도 변경사항을 내려받을 수 있지만 `pull` 은 자동으로 브랜치를 병합해주는데 반해 `fetch` 는 브랜치를 수동으로 병합하는 과정이 필요하다.

  ```bash
  $ git push (<원격 저장소 별칭>) (<브랜치 이름>)
  $ git pull
  $ git fetch
  ```

  - 브랜치 수동 병합하기 : 브랜치를 수동으로 병합하기 위해서 `merge` 명령어를 사용한다.

  ```bash
  $ git merge <원격 저장소 별칭>/<브랜치 이름>
  ```



- 충돌 방지하기 : 수시로 `pull` 명령어를 사용하여 로컬 저장소와 원격 저장소 상태를 최신으로 맞춰주는 것이 중요하다.
  - 권장 순서 : `pull - coding - commit - pull - push` 



# 브랜치(Branch)

- 깃을 사용하지 않는 경우, 원본 파일을 손상시키지 않고 수정을 하려면 파일의 사본을 생성해야만 한다. 하지만 깃을 사용하면 **브랜치(Branch)** 를 나누어 가상 폴더를 생성함으로써 원본을 보존하며 파일의 일부를 수정할 수 있다.



- 브랜치의 특징
  - 가상 폴더
  - 독립적인 동작
  - 빠른 동작



## 브랜치의 생성, 삭제, 관리

- 기본 브랜치 : 깃에서 하는 모든 커밋은 브랜치에 기록되므로 우리가 따로 브랜치를 만들어주지 않아도 기본적으로 하나의 브랜치가 만들어진다. 이를 master 브랜치라고 한다.



- 브랜치 생성하기 : master 브랜치 이외에 다른 브랜치는 직접 사용자가 만들어 주어야 한다. `branch` 명령어를 통해 새로운 브랜치를 생성하거나 존재하는 브랜치의 목록을 볼 수 있다.

```bash
$ git branch <브랜치 이름> (<커밋ID>)
# 커밋 ID를 지정하면 그 지점에서 새로운 브랜치가 생성된다.
# 지정하지 않으면 HEAD를 기준으로 브랜치를 생성한다.

$ git branch	# 어떤 브랜치가 있는지 목록을 볼 수 있다.
```



- 브랜치의 세부사항 확인하기

  - `-v` 혹은 `-verbose` 명령어를 사용하면 브랜치의 세부사항을 확인할 수 있다. 브랜치의 이름, 커밋 ID, 커밋 메시지를 확인할 수 있다. 

  ```bash
  $ git branch -v
  $ git branch -verbose
  ```

  

- 브랜치 이동 : 특정 브랜치에서 작업을 마치고 다른 브랜치로 이동하고 싶을 때에는 `checkout` 명령어를 사용한다. 브랜치를 이동하기 전에는 기존 브랜치의 워킹 디렉터리를 모두 정리해주어야 한다. (정리해주지 않으면 이동을 제한당함) `-b` 명령어를 추가하면 생성과 이동을 한꺼번에 수행할 수 있다. 

```bash
$ git checkout <브랜치 이름>
$ git checkout -
# 바로 이전 브랜치로 이동하고 싶을 때는 브랜치 이름대신 '-'을 입력하여 쉽게 이동할 수 있다.
$ git checkout -b <브랜치 이름>
# -b 이후에 생성되지 않은 브랜치 이름을 입력하면 생성/이동을 한꺼번에 수행할 수 있다.
```



## 브랜치 공간

- 브랜치 로그와 그래프 확인하기 : 작업한 로그를 확인할 때 `--graph --all` 명령어를 추가하면 브랜치의 그래프를 확인할 수 있다.

```bash
$ git log --graph --all
```



- HEAD 포인터
  - 브랜치를 이동하면 그에 맞추어 HEAD 포인터도 변경된다. HEAD 포인터는 커밋을 생성하고 브랜치를 관리하는 데 매우 유용한 도구이다.
  - HEAD를 기준으로 하여 상대적인 커밋 위치도 지정할 수 있다.
  - AHEAD 와 BHEAD : 원격 저장소와 연동하여 깃을 관리하면 브랜치마다 HEAD가 2개씩 존재한다. 이를 AHEAD와 BHEAD라고 한다.
    - AHEAD : 서버로 전송되지 않은 로컬 커밋 
    - BHEAD : 로컬 컴퓨터로 내려받지 않는 커밋



- 브랜치 이동 추가 : 위에서 본 대로 브랜치 이동은 `checkout` 을 통해서 할 수 있다. `checkout` 뒤에 브랜치 이름 대신 다른 명령어를 추가하여 이동할 수도 있다.

  - 커밋 해시 키로 이동하기 : 특정 브랜치를 생성할 때는 생성할 때의 커밋 해시 키에 브랜치 이름을 덮어 씌워 브랜치 목록에 등록한다. 때문에 브랜치 이름은 커밋 해시 키와 동일하다. 때문에 커밋 해시키를 사용하여 브랜치를 이동할 수도 있다.

  ```bash
  $ git checkout <커밋 해시 키>
  ```

  - HEAD를 활용하여 이동하기 : HEAD 포인터를 사용하여 브랜치를 이동할 수도 있다. `HEAD~` 명령어 뒤에 숫자(n)를 입력하여 n 단계만큼 앞으로 이동할 수 있다. 

  ```bash
  $ git check HEAD~1
  $ git check HEAD~3
  # HEAD~1은 HEAD보다 하나 앞 커밋, HEAD~3은 HEAD보다 3개 앞 커밋으로 이동한다.
  ```



## 원격 브랜치

- 리모트 브랜치 : 로컬이 아닌 원격 저장소에 생성한 브랜치. 로컬 저장소에서 새로운 브랜치를 생성한다고 원격 저장소에 브랜치가 생성되는 것은 아니다. 별도의 명령어를 통해 둘을 동기화해주어야 리모트 브랜치가 생성된다. `push` 하면서 브랜치 이름을 추가로 입력해주면 리모트 브랜치를 생성할 수 있다.

```bash
$ git push (<원격 저장소 별칭>) <브랜치 이름>
# 리모트 브랜치의 이름은 기본적으로 로컬과 같게 보내진다.
# 둘의 이름을 다르게 하고 싶다면 아래 명령어를 사용하면 된다.
$ git push origin <브랜치 이름>:<리모트 브랜치 이름>
```



- 업스트림 트래킹(Upstream Tracking) : 로컬 저장소의 특정 브랜치와 리모트 브랜치는 생성하면서 연결되어 있는데 둘을 연결해주는 것이 업스트림 트래킹이다.



- 브랜치 목록 추가 : 위에서는 로컬 저장소의 목록을 확인하는 것을 알아보았다. 깃은 그 외의 브랜치를 관리할 수 있는 명령어도 제공한다. 기본적으로는 `branch` 명령어를 사용하게 된다.

```bash
$ git branch -r		# 리모트 브랜치 목록 확인
$ git branch -a		# 모든 브랜치(로컬+리모트) 목록 확인
$ git branch -vv	# 트래킹 브랜치 확인
```

- 원격 브랜치 다루기 추가

  - 업스트림 만들기 : 아래의 명령어를 사용하여 업스트림을 만들 수 있다.

  ```bash
  $ git checkout --track origin/<브랜치 이름>
  ```

  - 원격 브랜치 복사하기 : 원격 저장소에만 있는 브랜치가 있다면 아래의 명령어를 사용해 로컬 저장소에도 새로운 브랜치를 생성하여 연동할 수 있다.

  ```bash
  $ git checkout -b <새 이름> origin/<브랜치 이름>
  ```

  - 업스트림 연결 : 기존 브랜치를 업스트림으로 직접 설정할 수 도 있다.

  ```bash
  $ git branch -u origin/<브랜치 이름>
  ```

  - 브랜치 푸시
  - 브랜치 페치

  ```bash
  $ git merge (<원격 저장소 별칭>) / <브랜치 이름>
  ```



- 브랜치 삭제하기

  - 일반적인 방법과 강제로 삭제하기

  ```bash
  $ git branch -d <브랜치 이름>
  $ git branch -D <브랜치 이름>
  ```

  - 리모트 브랜치 삭제하기 :

  ```bash
  $ git push origin --delete <리모트 브랜치 이름>
  ```

