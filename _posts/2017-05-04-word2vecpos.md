---
title: Word2Vec과 품사 정보
category: Natural Language Processing
tag: word class
html header: <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG"></script>
---

이번 글에서는 **Word2Vec**으로 임베딩한 단어 벡터가 **품사**의 종류와 어떤 연관을 맺고 있는지 살펴보도록 하겠습니다. 그럼 시작하겠습니다.



## 품사와 분포

한국어 품사를 분류할 때 가장 결정적인 기준은 바로 **기능(function)**이라고 합니다. 기능이란 해당 단어가 문장 내에서 어떤 역할을 하는지 나타내는 개념입니다. 그런데 한국어에서는 단어의 기능이 **분포(distribution)**와 매우 밀접한 관련을 맺고 있다고 합니다. 분포란 단어의 등장 순서나 위치를 말합니다. 이와 관련 자세한 내용은 [이곳](https://ratsgo.github.io/korean%20linguistics/2017/04/21/wordclass/)을 참고하시면 좋을 것 같습니다.

Word2Vec은 단어를 벡터로 바꾸는 **임베딩(Embedding)** 기법입니다. 특히 **Skip-Gram(SG)**의 경우 중심단어로 주변단어를 더 잘 예측하기 위해 단어벡터들을 조금씩 업데이트하면서 학습이 이뤄지는 구조입니다. 다시 말해 Word2Vec은 단어벡터를 만들 때 주변 단어의 분포 정보를 활용한다는 것이지요. 이와 관련 자세한 내용은 [이곳](https://ratsgo.github.io/from%20frequency%20to%20semantics/2017/03/30/word2vec/)을 참고하시면 좋을 것 같습니다.

어쨌든 제가 세운 가정을 다시 정리하면 아래와 같습니다.

> (1) 한국어 품사의 기능은 분포와 밀접한 관련이 있다.
>
> (2) Word2Vec은 분포 정보를 학습에 반영한다.
>
> (3) Word2Vec으로 임베딩된 단어 벡터엔 품사 정보가 내재해 있을 것이다.



## 실험 설계

이번 실험에 사용한 말뭉치는 영화 리뷰 사이트 '왓챠'에서 수집한 655만306개의 리뷰입니다. 여기에 **Branching Entropy(이하 BE)**와 **Cohesion Probability(이하 CP)** 기법을 적용해 각각 학습했습니다. BE와 CP는 모두 말뭉치를 글자 단위로 빈도를 세어서 단어일 가능성을 점수로 나타내는 기법인데요. BE는 단어의 외부 정보, CP는 단어의 내부 정보를 점수화한다는 점에 차이가 있습니다. BE에 대해 자세히 살펴보시려면 [이곳](https://ratsgo.github.io/from%20frequency%20to%20semantics/2017/05/06/BranchingEntropy/)을, CP에 관해서는 [이곳](https://ratsgo.github.io/from%20frequency%20to%20semantics/2017/05/05/cohesion/)을 참고하세요.

어쨌든 BE와 CP를 동시에 고려해 단어 점수 표를 만들고, 이를 바탕으로 말뭉치에 **tokenize**를 수행했습니다. 토크나이저 함수는 김현중 서울대 박사과정이 만든 토크나이저를 약간 커스터마이징했습니다. 아래와 같습니다.



```python
all_tokenized_contents = []
for review in reviews:
    tmp = [tokenize(token) for token in review.split()]
    tmp = flatten(tmp)
    all_tokenized_contents.append(tmp)

#############################################
# functions                                 #
#############################################
def tokenize(word, max_l_length=10):
    if (not word) or (len(word) <= 2):
        return word
    score = []
    for e in range(2, min(len(word), max_l_length)+1):
        subword = word[:e]
        _, branching = branching_dict.get(subword, (0, 0))
        cohesion, _, _, _ = cohesion_dict.get(subword, (0, 0, 0, 0))
        # (word, cohesion * branching entropy, length)
        score.append((subword, cohesion * branching, e)) 
    result1 = sorted(score, key=lambda x:(x[1], x[2]), reverse=True)[0][0]
    if len(result1) < len(word):
        result2 = word.replace(result1, "")
        if len(result2) > 2:
            result2 = cpbe_tokenize(result2)
        return [result1, result2]
    return result1
    
def flatten(tokens, basestring = str):
    result = []
    for token in tokens:
        if hasattr(token, "__iter__") and not isinstance(token, basestring):
            result.extend(flatten(token))
        else:
            result.append(token)
    return result
```



토크나이징한 결과물의 일부는 아래와 같습니다.



|            처리 전            |                  처리 후                   |
| :------------------------: | :-------------------------------------: |
| 지금도 가슴 한 켠에서 상영되고 있는 그런 영화 | 지금, 도, 가슴, 한, 켠에, 서, 상영, 되고, 있는, 그런, 영화 |
| 마지막 장면은 책을 읽으며 상상했던 그대로였다  |  마지막, 장면, 은, 책을, 읽으며, 상상, 했던, 그대로, 였다   |
|      화려한 의상과 소품 인테리어       |          화려한, 의상, 과, 소품, 인테리어           |
|   억지스러운 반전에 씁쓸하고 슬픈 이야기    |       억지스러운, 반전, 에, 씁쓸하고, 슬픈, 이야기       |
|   핀처가 세운 야심에 루니 마라가 차지한다   |   핀처, 가, 세운, 야심, 에, 루니, 마라, 가, 차지, 한다   |



이렇게 토크나이징을 수행한 말뭉치에 Word2Vec 기법을 적용했습니다. 하이퍼파라메터 조합은 아래와 같습니다.

> **embedding 차원 수** : 100
>
> **window 크기** : 3
>
> **min_count** : 100
>
> **Skip-Gram 적용**



## 실험 결과

**종결어미**를 중심으로 실험 결과를 살펴보겠습니다. 앞으로 나열할 표는 해당 단어벡터와 **코사인 유사도**가 가장 높은 단어들 100개 리스트입니다.

### -다

<p class="message">

다ㅋㅋ, 다ㅠㅠ, 다ㅠ, 다ㅜ, 다ㅎ, 다고, 다ㅡ, 다ㅋㅋㅋ, 다라는, 다ㅋ, 다ㅎㅎ, 다는, 다ㅋㅋㅋㅋㅋ, 다ㅋㅋㅋㅋ, 다더, 다던, 다구, 얌, 다며, 다면, 다란, 었다, 다던데, 다네, 다지만, 다거나, 다아, 다라고, 다의, 다와, 다잉, 에요, 구먼, 예요, 구만, 닷, 닼ㅋㅋㅋ, 다기, 라능, 었당, 엿다, 였다, 로구나, 죠, 었겠지, 다도, 에여, 야ㅠㅠ, 었군, 였음, 지요, 었음, 겠지, 였군, 었지만, 거든요, 더라, 단다, 노병은, 듯하다, 다에, 것같다, 거늘, 었는데, 란다, 라해도, 다라, 었달까, 엇다, 군, 더라도, 엇음, 랍니다, 야라는, 었더라, 였어, 구나, 었네, 다길래, 희안한, 었구나, 지ㅋ, 닼ㅋㅋ, 였어요, 었죠, 다진, 었으나, 였당, 지만, 네, 네요, 시다, 었잖아, 더군, 여, 엿는데, 군요, 로다, 었습니다, 당

</p>

<br>

### -구나

<p class="message">

구만, 군, 구먼, 군요, 겠구나, 었구나, 겠지, 거구나, 네, 거니, 죠, 네요, 지요, 네ㅋㅋ, 었군, 단다, 단걸, 지ㅋ, 당, 더라, 거늘, 네ㅠㅠ, 였구나, 네여, 을까, 달까, 었나, 었지, 넹, 건가, 건만, 했구나, 었네, 였군, 지라는, 더라는, 대요, 거죠, 도다, 답니다, 더군요, 냐, 잖아, 쟈나, 거야, 거다, 었는데, 는가, 가보다, 나보다, 겠죠, 거겠지, 네ㅋ, 드만, 갑다, 네ㅋㅋㅋ, 자나, 는대, 어, 냐만은, 거든요, 오랜만이네, 많구나, 더이다, 하구나, 어라, 을줄이야, 건데, 을꺼야, 지ㅠㅠ, 거였어, 노라, 음, 나봄, 거지, 아냐, 지ㅠ, 댜, 지ㅜ, 당ㅋ, 더군, 말인가, 닼ㅋㅋ, 습니다, 있구나, 걸까, 더냐, 쪄, 거든, 거냐, 어요, 지뭐, 음을, 었을까, 겟지, 지ㅋㅋㅋ, 으려나, 나, 겠나, 나봐

</p>

<br>

### -군

<p class="message">

군요, 구만, 구나, 구먼, 네요, 당, 죠, 네, 네여, 더라, 넹, 더군요, 지ㅋ, 달까, 단다, 지요, 겠지, 소, 더라는, 겠구나, 더군, 습니다, 네ㅋㅋ, 답니다, 네ㅠㅠ, 당ㅋ, 음, 긴함, 었군, 네ㅋ, 대요, 슴, 슴다, 자나, 었구나, 따, 지라는, 도다, 드만, 어요, 네용, 더이다, 거늘, 음ㅎㅎ, 읍니다, 더만, 냐만은, 건만, 어, 으려나, 는가, 는뎅, 습니까, 엌ㅋㅋㅋ, 었는데, 내요, 거든요, 거니, 겠죠, 긔, 긴하지만, 는디, 쟈나, 든데, 잖아, 네ㅋㅋㅋ, 냐, 나요, 겠군, 더냐, 음ㅋ, 음ㅎ, 을까, 단걸, 나ㅋㅋ, 닼ㅋㅋ, 겠지만, 겟지, 다잉, 다던데, 댜, 였군, 지ㅋㅋ, 국, 닼ㅋㅋㅋㅋㅋㅋ, 나보다, 나ㅠ, 긴한데, 겠네, 드라, 나뿐인가, 다ㅋㅋ, 거보면, 거죠, 음ㅋㅋㅋㅋ, 러시아, 닼ㅋㅋㅋ, 법, 닼ㅋㅋㅋㅋ, 말입니다

</p>

<br>

### -네

<p class="message">

더라, 넹, 네요, 네ㅋㅋ, 네ㅋ, 네ㅠㅠ, 네ㅋㅋㅋ, 더이다, 네여, 구만, 더만, 당, 잖아, 네용, 죠, 긔, 더군요, 거든요, 겠지, 더라는, 군, 거든, 구먼, 었네, 자나, 습니다, 쟈나, 어요, 냐, 는디, 음ㅎ, 엌ㅋㅋㅋ, 음ㅋㅋㅋㅋㅋㅋ, 구나, 드만, 군요, 쟈냐, 던데, 도다, 든데, 어, 지뭐, 닼ㅋㅋㅋㅋ, 당ㅋ, 어ㅋㅋㅋ, 음ㅎㅎ, 긴함, 더군, 음, 닼ㅋㅋㅋㅋㅋㅋ, 졍, 거늘, 구요, 따, 닼ㅋㅋ, 니깐, 나봄, 댜, 얔ㅋㅋㅋ, 음ㅋㅋㅋㅋ, 나보다, 지요, 던가, 겠죠, 겠네, 겠어, 음ㅋ, 엉, 구, 아ㅋㅋ, 나봐, 슴, 긴하지만, 느냐, 슴다, 나요, 는뎅, 었죠, 지ㅋ, 는데, 더니, 는줄, 어라, 겠니, 었는데, 앜ㅋㅋㅋㅋ, 을꺼야, 건만, 닼ㅋㅋㅋ, 읍니다, 소, 내요, 나봐요, 더냐, 겠냐, 을거야, 긴하, 는대, 어ㅠ, 긴한데

</p>

<br>

### -마

<p class="message">

마요, 마라, 마셈, 말아라, 맙시다, 말자, 마세요, 말아요, 할아, 말라고, 줘, 작작, 마세, 제발, 말기, 말길, 말라, 말구, 말어, 건들지마, 말던가, 만요, 말아, 주오, 말것, 마소, 해줘, 마도, 그만, 다오, 않겠습니다, 줘요, 아르, 쉬세요, 않니, 미츠, 아오, 둬, 주세요, 내버려둬, 것좀, 말란, 그랬어요, 해라, 말라는, 말아야, 지마, 말지어다, 루, 마로, 해봐, 않어, 에잇, 나대, 해주세요, 않으, 들아, 와라, 님아, 됐잖아, 놔, 머니, 아씨, 않겠, 마오, 씨바, 욧, 오, ㅆ, 함부로, 않아도, 죄짓고, 해줘요, 마들, 소서, 얘들아, 말지, 마시, 말걸, 하지말고, 세요, 징한, 못했습니다, 말고, 힝, 못함, 데어, 않겠다, 러면, 쉬게, 년아, 말거, 시팔, 혀, 나카, 씨발, 못햇다, 노노, 미라, 하십

</p>

<br>

### -냐

<p class="message">

냐고, 더냐, 던가, 죠, 맞냐, 잖아, 었냐, 냐가, 좋냐, 겠는가, 얔ㅋㅋㅋ, 네, 냐는, 더라, 겠냐, 라구요, 거늘, 겠나, 구만, 야ㅋㅋ, 겠니, 자나, 겠어, 냐면, 느냐, 겠지, 냐를, 이냐, 었니, 냐의, 란말, 다냐, 쟈나, 구먼, 지요, 냔, 거든, 뭔데, 었잖아, 되냐, 네ㅋ, 더라는, 지ㅋ, 드만, 죄야, 었을까, 중헌디, 참나, 었나, 야이, 었네, 려나, 었더라, 네ㅠㅠ, 냐만은, 나요, 하냐, 겠습니, 란다, 었지, 냐며, 을줄이야, 뭐냐, 뭐여, 거든요, 뭐요, 로다, 넹, 는가, 란말이, 입니까, 니까, 십니까, 더만, 라구, 이딴게, 라더니, 든, 겟네, 뭐야, 묻자, 겠어요, 었군, 했냐, 었구나, 지ㅋㅋㅋ, 야ㅠㅠ, 봤냐, 네ㅋㅋㅋ, 나봐요, 을까, 네ㅋㅋ, 느니, 죽느, 되든, 니라, 긔, 방탄유리, 구나, 였군

</p>

<br>

### -니

<p class="message">

니ㅠㅠ, 니요, 길래, 니깐, 면, 느니, 하니, 뇨, 더니, 는게, 구, 구요, 던데, 능, 곤, 니까, 했더니, 든가, 며, 한들, 면야, 기보단, 던가, 려니, 시고, 고는, 맙소사, 시니, 면서, 다보니, 깐, 셨나, 게다가, 라구, 는거, 하하하하하하, 는건, 니라, 려나, 는데, 더만, 십니까, 셔서, 는거야, 는걸, 겠나, 해야하나, 네ㅠㅠ, 냐, 거기다, 오, 보니, 대다, 했는데, 와아, 랬지, 말어, 리라, 고보면, 고보니, 네, 기엔, 라니, 고, 셨어요, 겠어, 하하, 니만, 기에, 리라고, 그런데, 려면, 되니, 네ㅋ, 랴, 못해, 지마, 세요, 젠장, 있으니, 제길, 싶었는데, 고서, 고도, 시면, 아아, 하더라도, 왔더니, 핳, 더구나, 누, 고선, 메, 우니, 아놔, 오니, 시오, 든데, 앗, 않습니

</p>

<br>

### -까

<p class="message">

까요, 까나, 깐, 텐데, 려나, 까라는, 꺼같다, 꺼야, 테니, 꺼같, 꼬, 라나, 까봐, 껄, 테니까, 을까, 줄이야, 런지, 련지, 꺼에요, 았을까, 땐, 울까, 있나, 있을까, 있겠습니까, 꺼다, 테지, 질까, 없으니, 쏘냐, 좋냐, 꺼면, 으려나, 있으려나, 으니, 습니까, 게요, 겠나, 때엔, 테다, 때는, 진데, 은데, 래, 찌, 됐지, 됬지, 법하, 어ㅠ, 꺼, 테고, 없겠지, 랴, 래요, 때, 리가, 냐, 있겠는가, 졍, 까를, 있으니, 을라, 같냐, 없겠, 수록, 거란, 있었을까, 거다, 을꺼야, 을거야, 될까, 을듯, 을거, 지경, 거야, 때다, 을지, 줄텐데, 지라도, 때의, 았나, 수있, 줄은, 겠네, 있겠구나, 었니, 는뎅, 뿐인데, 됐잖아, 거라고, 없겠다, 없죠, 있겠, 때랑, 겁니다, 때에는, 겠는가, 있겠지, 냐고

</p>

<br>

### -랴

<p class="message">

겠는가, 있겠는가, 리오, 십니까, 있으, 있겠습니까, 므로, 리라, 어떠하, 리, 겠냐, 어떠, 냐고, 겠니, 려나, 렴, 려면, 겠습니, 시라, 겠나, 까요, 세요, 련다, 쏘냐, 신가, 리란, 겠어, 잊으, 든, 던간에, 냐, 리라고, 더냐, 던가, 있냐, 노니, 시오, 든지, 니깐, 없으, 리라는, 셨다, 어찌, 었으, 시니, 시죠, 어떻고, 시겠, 니까, 셨나, 든간에, 어쩌, 됬든, 하랴, 까, 죠, 시다, 겠소, 신다면, 누, 있을까, 시고, 있나, 되든, 셨어요, 없겠지만, 습니까, 은가, 하겠는가, 리나, 않으, 련지, 저쩌고, 없으니, 셨는, 셔, 어떠냐, 래요, 꼬, 없습니다, 있습니까, 느냐에, 겠어요, 던지, 려구, 너희는, 시는, 말인가, 려한다, 시나, 며, 느냐, 라구, 니, 대수, 려니, 없군, 너라, 시길, 누가

</p>

<br>

### -라

<p class="message">

라고, 라서, 라하, 여서, 라며, 라길, 라할, 래서, 라곤, 라네, 니까, 여, 라구, 라니, 야, 라지만, 어서, 야라, 작이라, 다라고, 이라, 리라, 거라, 에요, 라구요, 라능, 라면, 라해, 니깐, 라라, 랄까, 야ㅠㅠ, 었기에, 예요, 라는, 란다, 랬다, 시라, 라거, 일거라, 라도, 다고, 엿다, 라해도, 라를, 에여, 기에, 라그, 얌, 랍니다, 얍, 그런지, 라지, 라의, 다라, 였기에, 왔기에, 일것이, 라가, 란, 이니, 이라고, 라던, 라와, 야지, 란걸, 겠거니, 아무리, 을거라고, 라기엔, 란건, 주라, 였단, 닷, 므로, 뭐니, 여야만, 칭할, 보더, 줘서, 였다, 야가, 있느, 지뭐, 얔ㅋㅋㅋ, 야겠다, 래, 자랑스럽게, 였으니, 랬지, 이기에, 진다고, 사극이라, 졌으, 문에, 꺼라, 엿음, 이제는, 였구나, 그래서

</p>

### -지

<p class="message">

지가, 지도, 지를, 지ㅠ, 려하지, 지ㅜ, 지ㅋㅋㅋ, 지는, 지ㅠㅠ, 진, 지ㅋ, 지요, 겠어, 겠냐, 되지, 냐고, 겠는가, 그렇지, 하지, 지않, 띄지, 지라는, 철들지, 죠, 리지, 징, 겠지, 키지, 지ㅋㅋ, 녹슬지, 입지, 시지, 었는지, 기란, 려나, 울지, 죽지, 는지, 달지, 겠군, 지지, 지의, 는가를, 냐, 겟음, 좋지, 겟어, 겠니, 거나, 보지, 구만, 쉽지, 디, 구애받지, 묻지, 하질, 스럽지, 오지, 되, 남지, 네ㅋ, 보질, 답지, 돋지, 느냐, 있지, 질, 늦지, 던가, 긴했, 려는지, 겠지만, 늙지, 넹, 겠나, 끼지, 잃지, 더냐, 겠음, 들지, 화하지, 뛰지, 겠구나, 단걸, 더라도, 나진, 지이, 겠다, 살진, 었지, 나지, 네요, 면서도, 는진, 많지, 줄지, 벗지, 겠죠, 닮지, 겟네

</p>

<br>

### -고

<p class="message">

고도, 고는, 고만, 며, 기보다, 고선, 고들, 을거라고, 는거, 던가, 구, 면서, 기보단, 고나, 곤, 을거라, 는건, 고싶다, 고서, 다고, 고라, 거나, 다라고, 는걸, 라고, 는것, 는게, 면서도, 었고, 던데, 고야, 는데, 느니, 니, 더니, 부시고, 혹자는, 을때가, 는듯, 구요, 든가, 그렇다고, 는거야, 지만, 듯이, 면, 다못해, 기고, 튀고, 그러면서, 어라, 게끔, 다보니, 맞고, 게하는, 겠소, 길래, 능, 기까지, 유치하다, 자고, 기만, 때리고, 야하고, 자부, 하고, 고가, 기전에, 헌데, 지않고, 을만, 기도, 었으나, 죽이고, 겠냐, 고싶, 지못, 우고, 나고, 었냐, 려는지는, 을거라는, 으라, 지말, 겠구나, 었나, 는구, 던걸, 었는지, 던영화, 더만, 았나, 었더라, 까놓고, 파헤치고, 냐고, 롭다고, 뛰고, 심각하게, 물론

</p>

<br>

### -며

<p class="message">

면서, 면서도, 하며, 기보단, 거나, 고, 기보다, 도록, 고도, 고선, 니, 려한다, 듯이, 느라, 다보니, 려하는, 리라, 므로, 다보면, 기위해, 십니까, 이며, 던가, 다니, 느냐에, 든가, 게된다, 려다, 게함, 지말, 느니, 걸으면서, 게한다, 내며, 기에, 가며, 시고, 되, 곤, 던지, 게하는, 하면서, 셔서, 셨나, 느냐, 기전에, 공유하며, 리며, 기엔, 다못해, 쓰며, 기전, 려는, 시니, 시던, 련다, 기에는, 려고, 러, 지않고, 려면, 기까지의, 려하지만, 않으며, 안으, 다가, 리면서, 신듯, 여, 게끔, 기만, 리만치, 타며, 던, 그러면서, 치며, 더니, 않고, 더라도, 고싶다, 신다, 기에도, 못하고, 려, 려던, 랴, 기까지, 우며, 되며, 쥐며, 길래, 키며, 바밤, 자마, 시는, 시길, 려나, 낌없이, 세요, 게한

</p>



