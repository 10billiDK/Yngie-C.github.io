---
title: Linearity, Linear combination
category: Linear Algebra
tag: Linear Discriminant Analysis
html header: <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG"></script>
---

이번 포스팅에선 **선형대수학(Linear Algebra)**의 **선형성(linearity)**, **선형결합(linear combination)** 등 주요 개념을 중심으로 기본을 짚어보도록 하겠습니다. 이번 글은 [고려대 박성빈 교수님]([hyperspace@korea.ac.kr](mailto:hyperspace@korea.ac.kr))과 [한양대 이상화 교수님](http://www.kocw.net/home/search/kemView.do?kemId=977757) 강의를 참고했음을 먼저 밝힙니다. 그럼 시작하겠습니다.



## 선형성

선형성이란 직선처럼 똑바른 도형, 또는 그와 비슷한 성질을 갖는 대상이라는 뜻으로, 함수의 경우 그 모양이 '직선'이라는 의미로 사용됩니다. 수학에서 선형성의 정의는 다음과 같습니다. 임의의 수 x, y와 함수 f에 대해 아래 두 조건을 동시에 만족해야 합니다.

> **superposition** : f(x+y) = f(x) + f(y)
>
> **homogeneity** : 임의의 수 a에 대해 f(ax) = af(x)

위 조건을 만족하는 예로는 1차 다항함수(y=mx), 미분/적분연산 등이 있습니다. 또한 행렬과 벡터 곱셈(multiplication)도 선형성을 가집니다. 다만 여기서 주의해야할 것은 원점을 지나지 않는 직선의 방정식(예를 들면 y=2x+1)은 위 선형성 조건에 위배됨을 확인할 수 있습니다. 원점을 통과하지 않는 직선에 굳이 선형성을 정의하려면 **x의 변화량과 y의 변화량에 선형성이 있다** 정도로 언급해야 할 것입니다. 선형대수학은 기본적으로 선형성을 지닌 방정식이나 함수에 대해 다룹니다.



## 1차 연립방정식 풀이의 두 가지 접근

보통 고등학교 수학과정에선 두 개의 1차 연립방정식의 해를 찾을 때 2차원 사분면에 두 개 직선을 그려, 두 직선의 교점을 찾는 것으로 설명을 하곤 합니다. 다시 말해 아래 그림과 같습니다.



$$3x-y=-2\\ x+y=2$$



<a href="http://imgur.com/Al0vdJ2"><img src="http://i.imgur.com/Al0vdJ2.png" title="source: imgur.com" /></a>



위 직선의 방정식은 아래와 같이 고쳐쓸 수 있습니다. 자세히 보시면 두 방정식에서 x, y의 계수들을 각각 떼어서 벡터 (3,1), (-1,1)로, 상수항들을 묶어서 벡터 (-2,2)로 표현을 한 걸 알 수 있습니다. 미지수 x와 y는 각각 스칼라 값이므로 [스칼라-벡터 곱의 정의](https://ratsgo.github.io/machine%20learning/2017/03/14/operations/)에 의해 위 직선의 방정식과 아래 벡터 형태가 정확히 동일하다는 것 또한 확인 가능합니다.



$$x\begin{bmatrix} 3 \\ 1 \end{bmatrix}+y\begin{bmatrix} -1 \\ 1 \end{bmatrix}=\begin{bmatrix} -2 \\ 2 \end{bmatrix}$$



위 식은 정확히 **선형결합(linear combination)** 정의에 맞는 식입니다. 선형결합이란 벡터들을 스칼라 곱과 벡터의 덧셈을 조합하여 새로운 벡터를 얻는 연산입니다. 스칼라-벡터 곱을 기하학적으로 생각하면 벡터의 길이를 키우거나 줄이는 걸로, 두 벡터의 덧셈은 두 벡터가 이루는 평행사변형의 대각선과 일치합니다. 위의 식의 세 벡터(x계수, y계수, 상수벡터)를 아래와 같이 2차원 평면 위에 그리면 아래 그림과 같습니다.

<a href="http://imgur.com/JgEGzmC"><img src="http://i.imgur.com/JgEGzmC.png" title="source: imgur.com" width="500px"/></a>

여기서 우리가 x, y 값을 구한다, 즉 1차 연립방정식의 해를 구한다는 건 빨간색 선과 파란색 선을 적절히 조합해 오렌지색 선으로 일치시키는 작업이라고 봐도 무방합니다. 다시 말해 1차 연립방정식의 해는 '직선의 방정식의 교점'으로도, '계수벡터의 선형결합으로 상수벡터를 표현'하는 방식으로도 모두 구할 수 있다는 이야기입니다. 이를 조금 더 확장해서 생각해보면, 위 연립방정식의 해가 존재한다는 것은 파란색 벡터가 오렌지색 벡터와 빨간색 벡터의 선형결합으로 표시될 수 있다는 걸 의미합니다. 반대로 해가 존재하지 않는다면 선형결합으로 나타낼 수 없다는 걸 뜻합니다. 이는 **벡터공간(Vector space)**, **생성(span)** 등 개념과 연결되는데 이 챕터의 범위를 넘어서므로 추후에 다시 논의하도록 하겠습니다.



## 확대행렬, 기본행연산, 가우스행렬, 행상등, 역행렬...

선형대수학의 기초 용어 몇 가지를 정의하고 넘어가겠습니다.

> **확대행렬(augmented coefficient matrix)** : 1차 연립방정식의 계수와 상수항으로 이뤄진 행렬

> **가우스행렬/행사다리꼴(row-echelon matrix)** : 다음 세 가지를 만족하는 행렬이다. (1) 영행이 있다면 그것은 영행이 아닌 행의 아래에 있다. (2) 영행이 아닌 행의 첫번째 0이 아닌 원소를 그 행의 **선도원소(leading entry)**라 하고 모든 선도원소는 1이다. (3) 영행이 아닌 연속된 두 행이 있을 때 각각 i번째 행과 i+1번째 행이라 한다면 i번째 행의 선도원소는 i+1번째 행의 선도원소보다 왼쪽에 있다(역계단모양)

> **추축열(pivot column)** : 가우스행렬의 각 행별로 선도원소에 대응하는 열을 추축열이라 한다.

> **기약가우스행렬(reduced echelon matrix)** : 가우스행렬 A에 대하여 i번째 행의 선도원소가 j번째 열에 있다면 j번째 열의 다른 모든 원소는 0이다(가우스행렬이면서 선도원소 위, 아래 모든 수가 0인 행렬)

아래 예시에서 A, B는 가우스행렬, C, D는  기약가우스행렬입니다. 가우스행렬이든 기약가우스행렬이든 구하는 이유는 선도원소에 해당하는 연립방정식의 해를 바로 찾을 수 있기 때문입니다. C는 x, y, z, 상수에서 도출한 확대행렬에서 얻어진 기약가우스행렬이라고 한다면, x의 해는 4, y=7, z=-1입니다.

$$A=\begin{bmatrix} 1 & 0 & 2 & 3 \\ 0 & 1 & 1 & 4 \\ 0 & 0 & 0 & 1 \end{bmatrix},\quad B=\begin{bmatrix} 1 & 1 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 0 \end{bmatrix}\\ C=\begin{bmatrix} 1 & 0 & 0 & 4 \\ 0 & 1 & 0 & 7 \\ 0 & 0 & 1 & -1 \end{bmatrix},\quad D=\begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}$$

A에서 추축열은 1, 2열입니다.  선형대수학에서 추축열은 대단히 중요한 개념인데요, 해당 행렬의 열 벡터들이 만드는 **열 공간(column space)**의 **기저(basis)**가 되기 때문입니다. (열 공간과 기저는 추후에 살펴보겠습니다) A열의 추축열이 아닌 3열은 추축열인 1열을 2배한 뒤 2열을 더하면(선형결합으로) 만들어 낼 수 있습니다.

> **기본행연산(elementary row operation)** : 임의의 확대행렬을 가우스행렬로 만드는 연산을 기본행연산이라고 한다. 기본행연산은 연립방정식의 **소거법**과 동일하다. 기본행연산에는 3개 방법이 있다. (1) **행 교환**(row switching transformations) : 행 순서를 바꿔도 해(영공간)가 바뀌지 않는다. (2) **상수 곱셈**(row-multiplying transformations) : 임의의 행 전체에 0이 아닌 상수를 곱해도 해가 바뀌지 않는다. (3) **한 행의 배수를 다른 행에 더함**(row-addition transformations) : 임의의 행에 c배를 하고 이것을 다른 행에 더해도 해가 바뀌지 않는다.

> **행상등(row-equivalent)** : 행렬 A에 기본행연산을 적용하여 행렬 B를 얻을 수 있는 경우 A와 B는 행상등이라고 한다.

> **단위행렬(identity matrix)** : 주대각선이 전부 1이고 나머지 원소는 0을 값으로 갖는 n x n 정방행렬. 단위 행렬은 행렬곱셈의 항등원이다.

> **역행렬(inverse matrix)** : n차 정방행렬 A에 대하여 AB=BA=I을 만족하는 행렬 B가 존재할 때 B를 A의 역행렬이라하고, 이때 A를 가역(invertible) 또는 정칙행렬이라 한다. 만일 이와 같은 B가 존재하지 않으면 A를 **특이행렬(singular matrix)**이라 한다.

> **위수(rank)** : 행렬 A에 기본행연산을 적용하여 가우스행렬로 만들었을 때 영행이 아닌 행의 수를 위수라고 한다. 위수는 가우스행렬의 추축열의 수, 그리고 행렬 A의 **차원(dimension)** 수와 일치한다.

> **자유변수(free variable)** : 말 그대로 아무 값이나 가져도 되는 미지수. 임의의 가우스행렬 A의 위수가 열의 개수보다 작으면 자유변수가 1개 이상 존재한다.

> **기본행렬(elementary matrix)** : 임의의 단위행렬에 대해 한 번의 기본행연산을 해서 얻어지는 행렬을 기본행렬(E)이라고 한다. 행렬 A에 E를 곱한 EA는 A에 기본행연산을 해서 얻은 행렬과 같다.

기본행렬과 관련한 예를 들어보겠습니다. 3x3 단위행렬의 첫번째 행에 3배를 해준 뒤 두번째 행에 더해준((3) 유형의 기본행 연산) 기본행렬 E는 아래와 같습니다. 이를 행렬 A에 같은 유형의 기본행연산을 한 직접 결과와 비교해 보면 정확하게 일치합니다.

$$A=\begin{bmatrix} 1 & 2 & 3 \\ 1 & 0 & 1 \\ 1 & 1 & 2 \end{bmatrix},\quad E=\begin{bmatrix} 1 & 0 & 0 \\ 3 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}\\ EA=\begin{bmatrix} 1 & 0 & 0 \\ 3 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}\begin{bmatrix} 1 & 2 & 3 \\ 1 & 0 & 1 \\ 1 & 1 & 2 \end{bmatrix}=\begin{bmatrix} 1 & 2 & 3 \\ 4 & 6 & 10 \\ 1 & 1 & 2 \end{bmatrix}\\ A=\begin{bmatrix} 1 & 2 & 3 \\ 1 & 0 & 1 \\ 1 & 1 & 2 \end{bmatrix}\longrightarrow \begin{bmatrix} 1 & 2 & 3 \\ 4 & 6 & 10 \\ 1 & 1 & 2 \end{bmatrix}$$

이상 논의를 종합하여 정리해보겠습니다.


> **Thorem** : 임의의 행렬 A와 B가 행상등하면 행렬 B에 대해 유한번의 기본행연산을 해서(=유한개의 기본행렬을 곱해서) A를 얻을 수 있다. 모든 기본행렬은 역행렬이 존재(가역)이고, 그 역행렬 또한 기본행렬이다. 행렬 A에 대해 유한 번의 기본행연산을 하여 단위행렬 I를 얻을 수 있을 때(=A와 I가 행상등일 때) 같은 기본행연산을 I에 대해 적용하여 A의 역행렬을 구할 수 있다. n x n 행렬 A가 가역(역행렬이 존재)이면 nx1 벡터 B에 대한 행렬방정식 AX=B는 유일한 해를 갖는다. n x n 행렬 A가 단위행렬 I와 행상등이면 AX=0의 해는 유일하다. AX=0의 해가 유일하면 행렬 A는 단위행렬 I와 행상등이다.
